package data.datahelper.impl;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Timestamp;
import java.util.HashMap;
import java.util.Map;

import data.datahelper.CreditDataHelper;
import po.CreditPo;
import po.OrderPo;

public class CreditDataMysqlHelper implements CreditDataHelper {
	
	static String sql = null;  
	
	static JDBCHelper db1 = null;  
	
	static ResultSet ret = null; 
	
	static int sta; 
	
	@Override
	public Map<Integer, CreditPo> getCreditData() {
		// TODO Auto-generated method stub
		
		sql = "select *from credit";//SQL语句  
		db1 = new JDBCHelper(sql);//创建DBHelper对象  
		Map<Integer, CreditPo> map = new HashMap<Integer, CreditPo>();
		    
		try {  
			ret = db1.pst.executeQuery();//执行语句，得到结果集  
		    while (ret.next()) {  
		    	double credit= ret.getDouble(1); 
		        int orderstate = ret.getInt(2);  
		        Timestamp startTime = ret.getTimestamp(3) ;
		        Timestamp endTime = ret.getTimestamp(4); 
		        Timestamp lastTime = ret.getTimestamp(5); 
		        int userId = ret.getInt(6);
		        double price = ret.getDouble(7);
		        int hotelId = ret.getInt(8);
		        String roomInfo = ret.getString(9);
		            
		        OrderPo orderPo=new OrderPo(orderId, orderstate, startTime, endTime, lastTime, userId, price, hotelId, roomInfo); 
		        map.put(orderId, orderPo);
		     }//显示数据  
		     ret.close();  
		     db1.close();//关闭连接  
		     } catch (SQLException e) {  
		    	 e.printStackTrace();  
			 }  
		return map;		
	}

	@Override
	public void updateCreditData(Map<Integer, CreditPo> map) {
		// TODO Auto-generated method stub

	}

}
