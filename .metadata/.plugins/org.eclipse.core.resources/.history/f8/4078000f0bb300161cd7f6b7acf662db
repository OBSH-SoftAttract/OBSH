package data.datahelper.impl;

import java.sql.Date;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.Map;

import data.datahelper.PromotionDataHelper;
import po.OrderPo;
import po.PromotionPo;

public class PromotionDataMysqlHelper implements PromotionDataHelper {
	
	static String sql = null;  
	
	static JDBCHelper db1 = null;  
	
	static ResultSet ret = null; 
	
	static int sta;
	
	@Override
	public Map<Integer, PromotionPo> getPromotionData() {
		// TODO Auto-generated method stub

	    sql = "select *from promotion";//SQL语句  
	    db1 = new JDBCHelper(sql);//创建DBHelper对象  
	    Map<Integer, PromotionPo> map = new HashMap<Integer, PromotionPo>();
	    
	    try {  
	    	ret = db1.pst.executeQuery();//执行语句，得到结果集  
	        while (ret.next()) {  
	        	int orderId = ret.getInt(1);  
	            int orderstate = ret.getInt(2);  
	            Date startTime = ret.getDate(3);  
	            Date endTime = ret.getDate(4); 
	            Date lastTime = ret.getDate(5); 
	            int userId = ret.getInt(6);
	            double price = ret.getDouble(7);
	            int hotelId = ret.getInt(8);
	            String roomInfo = ret.getString(9);
	            
	            PromotionPo promotionPo=new PromotionPo(orderId, orderstate, startTime, endTime, lastTime, userId, price, hotelId, roomInfo); 
	            map.put(orderId, PromotionPo);
	        }//显示数据  
	        ret.close();  
	        db1.close();//关闭连接  
	     } catch (SQLException e) {  
	        e.printStackTrace();  
	     }  
		return map;
	}

	@Override
	public void updatePromotionData(Map<Integer, PromotionPo> map) {
		// TODO Auto-generated method stub
		
	}

}
