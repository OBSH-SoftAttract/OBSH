package data.datahelper.impl;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.Map;

import data.datahelper.HotelDataHelper;
import po.HotelPo;
import po.UserPo;

public class HotelDataMysqlHelper implements HotelDataHelper {
	static String sql = null;  
	static JDBCHelper db1 = null;  
	static ResultSet ret = null;  
	static int sta;  
	
	@Override
	public  Map<Integer, HotelPo> getHotel() {
		// TODO Auto-generated method stub
		
	    sql = "select *from hotel";//SQL语句  
	    db1 = new JDBCHelper(sql);//创建DBHelper对象  
	    Map<Integer, HotelPo> map = new HashMap<Integer, HotelPo>();
	    
	    try {  
	    	ret = db1.pst.executeQuery();//执行语句，得到结果集  
	        while (ret.next()) {  
	        	int id = ret.getInt(1);  
	            String hotelName = ret.getString(2);  
	            int startLevel = ret.getInt(3);  
	            String location = ret.getString(4); 
	            int credit = ret.getInt(5);
	            boolean isVIP = false;
	            if(ret.getInt(6)==1)
	            	isVIP = true;
	            else 
	            	isVIP = false;
	            
	        	UserPo userPo=new UserPo(id, password, contactinfo, name, credit, isVIP);
				map.put(id, userPo);
	            
	        }//显示数据  
	        ret.close();  
	        db1.close();//关闭连接  
	     } catch (SQLException e) {  
	        e.printStackTrace();  
	     }  
		return map;
	}

	@Override
	public boolean updateHotel(HotelPo hotelPo) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean addHotelPo(HotelPo hotelPo) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean deleteOrderPo(int hotelId) {
		// TODO Auto-generated method stub
		return false;
	}

}
